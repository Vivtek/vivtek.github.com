<html>
<head>
<title>ActiveX is here - Javascript exploit sign</title>
<style>p, li, td {
font-family: arial, sans-serif;
}
p.smtitle {
margin-left:0px;background-color:#eeeeee;font-weight:bold;
}
.sidemenu p {
font-size:small;
margin-top:0px;
margin-bottom:2px;
margin-left:10px;
}
.title {
font-family: arial, sans-serif;
font-weight: bold;
font-size:x-large;
color:black;
background-color:#eeeeee;
}
.subtitle {
font-family: arial, sans-serif;
font-size:small;
}
.t2 {
font-family: arial, sans-serif;
font-weight: bold;
font-size:large;
color:black;
background-color:#eeeeee;
}
.st2 {
font-family: arial, sans-serif;
font-size:x-small;
}
.border {
border: 1px solid #336600;
}
.content {
}
pre.code {
  margin: .5em 1em;
  padding: 0.5em;
  border: 1px dashed #94bd8d;
  color: Black;
  background-color: #eff7ef;
  overflow: auto;
}
</style>
</head>
<body>
<table width="100%">
<tr>
<td valign="top" width="150px"><div class="sidebar">
<div class="border">
<div class="sidemenu">
<p class="smtitle">vivtek</p>
<p>[ <a href=/>home</a> ]</p>
<p>[ <a href=/blog/>blog</a> ]</p>
<p>[ <a href=/recent.html>recent</a> ]</p>
<p>[ <a href=/fiction/>fiction</a> ]</p>
<p>[ <a href=/toonbots/>toonbots</a> ]</p>
<p>[ <a href=/wftk/>workflow</a> ]</p>
<p>[ <a href=/projects/>programming</a> ]</p>
<p>[ <a href=/services.html>translation</a> ]</p>
<p>[ <a href=http://semantic-programming.blogspot.com/>semprog&nbsp;blog</a> ]</p>
<p>[ <a href=/contact.html>contact</a> ]</p>
</div>

<div class="sidemenu">
<p class="smtitle">despammed</p>
<p>[ <a href="http://www.despammed.com/">despammed site</a> ]</p>
<p>[ <a href="/projects/despammed/">programming</a> ]</p>
<p>[ <a href="/projects/despammed/stormspam.html">botnet tracker</a> ]</p>
</div>

<hr />
<script type="text/javascript"><!--
google_ad_client = "pub-7508846022405297";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_ad_type = "text";
google_ad_channel = "";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<a href="/blog/t/ah_google_adsense_we_hardly_knew_ye!.html">Where
did my Google go?</a>

</div>

</div>
</td>
<td valign="top"><div class="content">

<div class="title">ActiveX is here - Javascript exploit sign</div>
This week the botnet's landing pages (e.g. <a href="storm_page_analysis_924353914-158796193.html">this one</a>) contain a fossil function  activex_is_here, which looks like this:
</p><p>
<pre class="code">
function activex_is_here()
{
    try
    {
        return false;
    }
    catch(e)
    {
        ;
    }

    return false;
}
</pre>
</p><p>
This reminded me of an earlier occurrence of the same function in earlier pages, for instance the <a href="view_page.html?id=1721407398-3114860513">PornTube landing pages</a> spammed in the first week of July.  There, the function still did something:
</p><p>
<pre class="code">
function activex_is_here()
{
    try
    {
        var testObject = new ActiveXObject("videoPl.chl");
        return true;
    }
    catch(e)
    {
        ;
    }

    return false;
}
</pre>
</p><p>
It attempts to load "videoPl.chl", and if it fails, the exploit knows that the browser doesn't support ActiveX.
</p><p>
Interesting enough, but a little Googling never hurt anybody, so I Googled for "function activex_is_here()", thinking it might be a decent index for exploits.  And of course, as always, when I got there, everybody else had already been.  For instance, on the <a href="http://forum.kaspersky.com/index.php?s=9f698d3a7e30fe6678f8cc36d5c5f2e9&showtopic=74817&pid=684615&mode=threaded&start=#entry684615">Kaspersky forum</a> there's a lively discussion of adding bits and pieces of Javascript as virus sign, but I was more interested in the version of this function they cite:
</p><p>
<pre class="code">
function activex_is_here()
{
try
{
    var testObject = new ActiveXObject("Ksec.Chl");
    return true;
}
catch(e)
{
        try {
            var testObject = new ActiveXObject("KsecX.chl");
            return true;
        }
        catch(e) {
;
        }
}
return false;
}
</pre>
</p><p>
That's dated June 8 of this year.  It's even more complete.  There's also a mention in April of 2007 at a <a href="http://pandalabs.pandasecurity.com/archive/FakeImages_210021002100_.aspx">PandaLabs blog</a>.
</p><p>
So this is one component of an exploit pattern that's been in use for over a year (at least), and is otherwise not too interesting.  I'd be tempted to say, however, that any page with a Javascript function activex_is_here should be examined for further signs of untrustworthiness.
</p><p>
</p><p>

</div></td></td></table>

<br><br><br><br>
    <center><img src="/images/black.gif" height=1 width=300><br>
    <Font Size="-1"><a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.</Font>
</center>


</body>
</html>
