
/* Refreshes Parent Window And Opens Link In A New Window.*/
function newWindow(obj) {
	var openChild = window.open(obj.href);
	openChild.focus();
	obj.href = "#";
	window.location = window.location;
	return false;
}

function refreshWindow() {
	var url=window.location.href;
	if(url.indexOf("&refresh", 0)==-1) {
		window.location.href = url+"&refresh=1";
	} else {
		window.location.href = url;
	}
}

/** Macromedia Image Rollovers And Preloads */
function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}

function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}

/* Creates Clickable Areas Within Search Results */
function createHandlers() {
	if (outerDiv=document.getElementById('outer')) {
		if (!outerDiv.getElementsByTagName('ul')) return false;
		var ulDiv=outerDiv.getElementsByTagName('ul');
		for (i=0;i<ulDiv.length;i++) {
			if (ulDiv[i].parentNode.className!='toplisting' || ulDiv[i].parentNode.className!='rightlisting') {
				var ulDivChild=ulDiv[i].getElementsByTagName('li');
				for (j=0;j<ulDivChild.length;j++) {
					//ulDivChild[j].onmouseover=getEvent;
					ulDivChild[j].onmouseout=getEvent;
					ulDivChild[j].onclick=getEvent;
				}
			}
			else if (ulDiv[i].parentNode.className!='weblisting') {
				var ulDivChild=ulDiv[i].getElementsByTagName('li');
				for (k=0;k<ulDivChild.length;k++) {
					//ulDivChild[k].onmouseover=getEvent;
					ulDivChild[k].onmouseout=getEvent;
					ulDivChild[k].onclick=getEvent2;
				}
			}
		}
	}
}

function goToStatus(targURL) {
   while (targURL.tagName !='LI') targURL=targURL.parentNode;
   var sStatus='go to ' +targURL.getElementsByTagName('div')[2].innerHTML;
   return window.status=sStatus;
}

function goToLocation(targURL) {
   if (targURL.tagName=='A') return true;
   while (targURL.tagName !='LI') {
      targURL=targURL.parentNode;
      if (targURL.tagName=='A') return true;
   }
   var targetLink=targURL.getElementsByTagName('a')[0];
   showURL=targetLink.href.replace(/#/g,'%23');
   window.open(showURL);
   return false;
}

function goToLocation2(targURL) {
	if (targURL.tagName=='A') return true;
	while (targURL.tagName !='LI') {
		targURL=targURL.parentNode;
		if (targURL.tagName=='A') return true;
	}
	var targetLink=targURL.getElementsByTagName('a')[0];
	showURL=targetLink.href.replace(/#/g,'%23');   
	window.open(showURL);
	window.location = window.location;
	return false;
}

function getEvent(activeEvent) {
	if (activeEvent) activeEvent = activeEvent;
	else {
		if (window.event) activeEvent = window.event;
		else activeEvent = "";
	}
	if (activeEvent) {
		if (activeEvent.target) {
			if (activeEvent.target.nodeType==3)	targetURL = activeEvent.target.parentNode;
			else targetURL = activeEvent.target;
		}
		else targetURL = activeEvent.srcElement;
		switch(activeEvent.type) {
			case 'mouseover': return goToStatus(targetURL); break;
			case 'mouseout': return window.status=''; break;
			case 'click': return goToLocation(targetURL); break;
		}
	}
}

function getEvent2(activeEvent) {
	if (activeEvent) activeEvent = activeEvent;
	else {
		if (window.event) activeEvent = window.event;
		else activeEvent = "";
	}
	if (activeEvent) {
		if (activeEvent.target) {
			if (activeEvent.target.nodeType==3)	targetURL = activeEvent.target.parentNode;
			else targetURL = activeEvent.target;
		}
		else targetURL = activeEvent.srcElement;
		switch(activeEvent.type) {
			case 'mouseover': return goToStatus(targetURL); break;
			case 'mouseout': return window.status=''; break;
			case 'click': return goToLocation2(targetURL); break;
		}
	}
}